The Spanish-French war that ensued from 1635 onwards was not a foregone conclusion. Early Spanish successes threatened Paris, and even after the Spanish defeat at Rocroi, Spain remained a strong opponent. But from 1640 onwards, a period which saw large-scale revolts across Spanish territories in protest against the rising costs of the conflict, Spain was finding it difficult to sustain the war. Philip reacted to the increased French threat by finally abandoning his 'Netherlands first' strategy; resources for the Army of Flanders were savagely cut, and the fight against the French-supported rebels Catalonia took the first priority.[37] Shortly after Rocroi, Philip – now having had to dismiss his favourite, Olivares – issued instructions to his ambassadors to seek a peace treaty. The Peace of Westphalia, delivered by Olivares' replacement Luis de Haro, resolved the long running Eighty Years' War in the Netherlands and the wars in Germany, but the conflict with France dragged on. Philip responded to the perceived weakness of France during the Fronde rebellions of 1648 by continuing the fight; he took personal responsibility for the decision to start a fresh, and ultimately successful, offensive against the French in Catalonia in 1651.[38] True victory over France never emerged, however, and by 1658, after the loss of Dunkirk to an Anglo-French force, Philip was personally desperate for peace.[39] The Treaty of the Pyrenees in 1659, and the marriage of Philip's daughter Maria Theresa to the young King Louis XIV[40] finally brought the war with France to a conclusion. The war against Portugal continued however, as Philip fruitlessly attempted to regain control over his lost kingdom.
